---
title: "Agriculture Dataset Exploratory Analysis"
description: |
  Exploratory analysis of the crop production data source. 
author:
  - name: Aditi Gautam
    url: https://github.com/adgautam
date: "`r Sys.Date()`"
output: 
    radix::radix_article:
      toc: true
      toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE,
	rows.print=5
)

options(tibble.max_extra_cols = 5, tibble.print_max = 5)

library(fs) # cross-platform file system operations
```

#Importing dataset

```{r}
library(fs)

agri <- read_csv(path("apy.csv"))
```

#Exploring and summarizing the dataset

```{r layout="l-body-outset"}
agri
```

```{r}
glimpse(agri)
```

```{r}
library(skimr)

skim(agri)
```

```{r}
unique_crop <- unique(agri[c("Crop")])
staple_crops <- agri[ which(agri$Crop=='Rice' | agri$Crop=='Sugarcane'
| agri$Crop=='Lentil' | agri$Crop=='Potato' | agri$Crop=='Onion' 
| agri$Crop=='Wheat' ), ]
```


#Reshaping the dataset to wide (by each district)

```{r}
staple_crops_wide <- staple_crops %>% 
  pivot_wider(
    names_from = Crop,  
    values_from = c(Season, Crop_Year, Production, Area)
  )

staple_crops_wide
```
```{r}
ggplot(data = staple_crops_wide) +
  aes(x = , y = ) +
  geom_col() +
  coord_flip() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(
    panel.grid.major.y = element_blank(),
    axis.text.y = element_text(margin = margin(r = -15)),
    plot.caption = element_text(face = "italic", color = "darkgrey", margin = margin(t = 10))
  ) +
  labs(
    title = '10 "Worst" Landlords in Brooklyn',
    subtitle = "Total HPD Violations in All Buildings for 2017",
    x = NULL,
    y = "Number of Violations",
    caption = "Source: NYC Public Advocate's Landlord Watchlist"
  )
```

