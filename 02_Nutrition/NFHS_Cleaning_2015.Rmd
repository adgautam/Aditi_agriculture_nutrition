---
title: "Nutrition Dataset Exploratory Analysis -2015"
description: |
  Exploratory analysis of the NFHS survey data from 2015-16. 
author:
  - name: Aditi Gautam
    url: https://github.com/adgautam
date: "`r Sys.Date()`"
output: 
    radix::radix_article:
      toc: true
      toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE,
	rows.print=5
)

options(tibble.max_extra_cols = 5, tibble.print_max = 5)

library(fs) # cross-platform file system operations
library(tidyverse)
library(skimr)
library(readxl)
library(janitor)
```

# Importing dataset

```{r}
nfhs2015 <- read_csv(path("NFHS_2015.csv"))
spec(nfhs2015)
```

```{r layout="l-body-outset"}
nfhs2015
```

```{r}
glimpse(nfhs2015)
```

```{r}
skim(nfhs2015)
```

Cleaning and standardizing variable names

```{r}
nfhs2015 <- clean_names(nfhs2015)
```

For now, we will be focussing on the three variables related to nutrition: Stunting, Underweight, Wasting

```{r}
keeps <- c("state","district","stunting_range_d","uw_range_d","wasting_range_d","rural_population","urban_population","total_population","x12_women_who_are_literate_percent","x13_men_who_are_literate_percent")
nfhs2015_subset = nfhs2015[keeps]
```

Recoding the values of columns: stunting_range_d, uw_range_d, wasting_range_d

Stunting
```{r}
nfhs2015_subset["stunting_range_d"][nfhs2015_subset["stunting_range_d"] == "Low (< 25%)"] <- "0"
nfhs2015_subset["stunting_range_d"][nfhs2015_subset["stunting_range_d"] == "Medium (25% - 40%)"] <- "0.5"
nfhs2015_subset["stunting_range_d"][nfhs2015_subset["stunting_range_d"] == "High (> 40%)"] <- "1"
nfhs2015_subset$stunting_range <- as.numeric(nfhs2015_subset$stunting_range_d)
```

Underweight
```{r}
nfhs2015_subset["uw_range_d"][nfhs2015_subset["uw_range_d"] == "Low (< 20%)"] <- "0"
nfhs2015_subset["uw_range_d"][nfhs2015_subset["uw_range_d"] == "Medium (20% - 40%)"] <- "0.5"
nfhs2015_subset["uw_range_d"][nfhs2015_subset["uw_range_d"] == "High (> 40%)"] <- "1"
nfhs2015_subset$uw_range <- as.numeric(nfhs2015_subset$uw_range_d)
```

Wasting
```{r}
nfhs2015_subset["wasting_range_d"][nfhs2015_subset["wasting_range_d"] == "Low (< 15%)"] <- "0"
nfhs2015_subset["wasting_range_d"][nfhs2015_subset["wasting_range_d"] == "Medium (15% - 25%)"] <- "0.5"
nfhs2015_subset["wasting_range_d"][nfhs2015_subset["wasting_range_d"] == "High (> 25%)"] <- "1"
nfhs2015_subset$wasting_range <- as.numeric(nfhs2015_subset$wasting_range_d)
```

Dropping extra variables

```{r}
keeps <- c("state","district","stunting_range","uw_range","wasting_range","rural_population","urban_population","total_population","x12_women_who_are_literate_percent","x13_men_who_are_literate_percent")
nfhs2015_subset = nfhs2015_subset[keeps]
```

```{r}
nfhs2015_subset <- nfhs2015_subset %>% mutate(state = toupper(state))
nfhs2015_subset <- nfhs2015_subset %>% mutate(district = toupper(district))
```

Exporting the cleaned dataset

```{r}
write.csv(nfhs2015_subset, file = "NFHS2015_Cleaned.csv")
```

Table with stunting, underweight and wasting by state

```{r}
nfhs2015_summary <-
  list("Stunting" =
       list("median"    = ~ median(stunting_range),
            "mean" = ~ qwraps2::mean(stunting_range)),
       "Under-weight" =
       list("median"    = ~ median(uw_range),
            "mean" = ~ qwraps2::mean(uw_range)),
       "Wasting" =
       list("median"    = ~ median(wasting_range),
            "mean" = ~ qwraps2::mean(wasting_range))
       )
```

```{r}
nfhs_bystate <- group_by(nfhs2015_subset, state) %>% 
  summarise_at(c("stunting_range", "uw_range", "wasting_range"), mean, na.rm = TRUE)
```

```{r}
write.csv(nfhs_bystate, file = "NFHS2015_ByState.csv")
```


